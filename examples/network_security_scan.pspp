# PSP ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ìŠ¤ìº” ì˜ˆì œ
# PowerShell ê¸°ë°˜ ë³´ì•ˆ í…ŒìŠ¤íŒ… ë„êµ¬

Write-Host "ğŸ” PSP ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ìŠ¤ìº” ì‹œì‘" -ForegroundColor Cyan

# Cì–¸ì–´ ìŠ¤íƒ€ì¼ ë³€ìˆ˜ ì„ ì–¸
string $target = "scanme.nmap.org"
array $commonPorts = @(21, 22, 23, 25, 53, 80, 110, 443, 993, 995, 3389)
hashtable $scanConfig = @{
    Timeout = 3
    Threads = 10
    Verbose = $true
}

Write-Output "ëŒ€ìƒ í˜¸ìŠ¤íŠ¸: $target"
Write-Output "ìŠ¤ìº” í¬íŠ¸: $($commonPorts.Count)ê°œ"

# ê¸°ë³¸ ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
Write-Host "`n1. í˜¸ìŠ¤íŠ¸ ì—°ê²°ì„± í…ŒìŠ¤íŠ¸" -ForegroundColor Yellow
hashtable $pingResult = Test-NetConnection $target

if ($pingResult.PingSucceeded) {
    Write-Host "âœ“ í˜¸ìŠ¤íŠ¸ $target ì‘ë‹µ í™•ì¸" -ForegroundColor Green
} else {
    Write-Host "âœ— í˜¸ìŠ¤íŠ¸ $target ì‘ë‹µ ì—†ìŒ" -ForegroundColor Red
}

# í¬íŠ¸ ìŠ¤ìº” ì‹¤í–‰
Write-Host "`n2. í¬íŠ¸ ìŠ¤ìº” ì‹¤í–‰" -ForegroundColor Yellow
array $scanResults = Invoke-PortScan $target -Port $commonPorts

Write-Output "ìŠ¤ìº” ê²°ê³¼:"
$scanResults | Where-Object { $_.Status -eq "Open" } | ForEach-Object {
    Write-Host "  âœ“ í¬íŠ¸ $($_.Port) ($($_.Service)) - ì—´ë¦¼" -ForegroundColor Green
}

# ì—´ë¦° í¬íŠ¸ë¡œ ì„œë¹„ìŠ¤ ìƒì„¸ í…ŒìŠ¤íŠ¸
Write-Host "`n3. ì„œë¹„ìŠ¤ ìƒì„¸ ë¶„ì„" -ForegroundColor Yellow

$scanResults | Where-Object { $_.Status -eq "Open" } | ForEach-Object {
    string $port = $_.Port
    string $service = $_.Service
    
    Write-Output "í¬íŠ¸ $port ($service) ë¶„ì„ ì¤‘..."
    
    if ($port -eq 80 -or $port -eq 443) {
        # HTTP/HTTPS ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
        Write-Output "  ì›¹ ì„œë¹„ìŠ¤ íƒì§€ë¨"
        
        # ì›¹ ì·¨ì•½ì  ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜
        string $protocol = if ($port -eq 443) { "https" } else { "http" }
        string $baseUrl = "${protocol}://${target}:${port}"
        
        Write-Output "  ê¸°ë³¸ ì›¹ ìŠ¤ìº”: $baseUrl"
        
        # SQL ì¸ì ì…˜ í…ŒìŠ¤íŠ¸
        hashtable $sqlTest = Test-SQLInjection -Url "$baseUrl/search" -Parameter "q" -Payload "' OR 1=1 --"
        
        if ($sqlTest.Vulnerable) {
            Write-Host "  âš ï¸  SQL ì¸ì ì…˜ ì·¨ì•½ì  ë°œê²¬!" -ForegroundColor Red
        } else {
            Write-Host "  âœ“ SQL ì¸ì ì…˜ ì·¨ì•½ì  ì—†ìŒ" -ForegroundColor Green
        }
    }
    
    if ($port -eq 22) {
        # SSH ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
        Write-Output "  SSH ì„œë¹„ìŠ¤ íƒì§€ë¨"
        Write-Output "  SSH ë²„ì „ ë° ì•Œê³ ë¦¬ì¦˜ í™•ì¸ í•„ìš”"
    }
    
    if ($port -eq 21) {
        # FTP ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
        Write-Output "  FTP ì„œë¹„ìŠ¤ íƒì§€ë¨"
        Write-Output "  ìµëª… ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ í•„ìš”"
    }
}

# ì‹œìŠ¤í…œ ì •ë³´ ìˆ˜ì§‘
Write-Host "`n4. ëŒ€ìƒ ì‹œìŠ¤í…œ ì •ë³´ ìˆ˜ì§‘" -ForegroundColor Yellow

# ì•”í˜¸í™” í…ŒìŠ¤íŠ¸
Write-Host "`n5. ì•”í˜¸í™” ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸" -ForegroundColor Yellow

string $testData = "sensitive_data_123"
string $md5Hash = ConvertTo-MD5Hash $testData
string $sha256Hash = ConvertTo-SHA256Hash $testData

Write-Output "í…ŒìŠ¤íŠ¸ ë°ì´í„°: $testData"
Write-Output "MD5 í•´ì‹œ: $md5Hash"
Write-Output "SHA256 í•´ì‹œ: $sha256Hash"

# í•´ì‹œ í¬ë˜í‚¹ ì‹œë®¬ë ˆì´ì…˜
Write-Output "`nê°„ë‹¨í•œ í•´ì‹œ í¬ë˜í‚¹ í…ŒìŠ¤íŠ¸:"
array $commonPasswords = @("password", "123456", "admin", "test", "hello")
string $targetHash = ConvertTo-MD5Hash "admin"

Write-Output "ëŒ€ìƒ í•´ì‹œ: $targetHash"

$commonPasswords | ForEach-Object {
    string $candidate = $_
    string $candidateHash = ConvertTo-MD5Hash $candidate
    
    if ($candidateHash -eq $targetHash) {
        Write-Host "  âœ“ í•´ì‹œ í¬ë˜í‚¹ ì„±ê³µ: '$candidate'" -ForegroundColor Green
    }
}

# ë³´ê³ ì„œ ìƒì„±
Write-Host "`n6. ìŠ¤ìº” ë³´ê³ ì„œ ìƒì„±" -ForegroundColor Yellow

hashtable $report = @{
    Target = $target
    ScanTime = Get-Date
    OpenPorts = ($scanResults | Where-Object { $_.Status -eq "Open" }).Count
    TotalPorts = $commonPorts.Count
    Vulnerabilities = @("SQL Injection ê°€ëŠ¥ì„±")
    Recommendations = @(
        "ë¶ˆí•„ìš”í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”"
        "ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì…ë ¥ ê²€ì¦ ê°•í™”"
        "ì •ê¸°ì ì¸ ë³´ì•ˆ ì—…ë°ì´íŠ¸"
    )
}

Write-Output "`n=== ìŠ¤ìº” ë³´ê³ ì„œ ==="
Write-Output "ëŒ€ìƒ: $($report.Target)"
Write-Output "ìŠ¤ìº” ì‹œê°„: $($report.ScanTime)"
Write-Output "ì—´ë¦° í¬íŠ¸: $($report.OpenPorts)/$($report.TotalPorts)"

Write-Output "`në°œê²¬ëœ ì·¨ì•½ì :"
$report.Vulnerabilities | ForEach-Object {
    Write-Host "  âš ï¸  $_" -ForegroundColor Red
}

Write-Output "`nê¶Œì¥ì‚¬í•­:"
$report.Recommendations | ForEach-Object {
    Write-Output "  â€¢ $_"
}

Write-Host "`nâœ… PSP ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ìŠ¤ìº” ì™„ë£Œ" -ForegroundColor Green
